# spring data jpa 구현체 분석
- 스프링 데이터의 공통의 구현체
- SimpleJpaRepository
- @Repository 적용: JPA 예외를 스프링이 추상화한 예외로 변환
- @Transctional : 트랜잭션 적용
  - JPA의 모든 변경은 트랜잭션 안에서 동작
  - 스프링 데이터JPA는 변경(등록, 수정, 삭제) 메서드를 트랜잭션 처리
  - 서비스 계층에서 트랜잭션을 시작하지 않으면 리파지토리에서 트랜잭션 시작
  - 서비스 계층에서 트랜잭션을 시작하면 리파지토리는 해당 트랜잭션을 전파 받아서 사용
  - 그래서 스프링 데이터JPA를 사용할 떄 트랜잭션이 없어도 데이터 등록, 변경이 가능했음(사실은 트랜잭션이 리포지토리 계층에 걸려 있었음)
- @Transctional(readOnly = true)
  - 데이터를 단순히 조회만 하고 변경하지 않은 트랜잭션에서 readOnly = true 옵션을 사용하면 플러시 생략해서 약간의 성능 향상을 얻을 수 있음

> 매우중요 !!!!   
> save() 메서드
> - 새로운 엔티티면 저장 persist
> - 새로운 엔티티가 아니면 병합 merge

- 새로운 엔티티를 판단하는 기본 전략
  - 식별자가 객체일 때 null로 판단
  - 식별자가 자바 기본타입일 때 0으로 판단
  - persistable 인터페이스를 구현해서 판단 로직 변경 가능